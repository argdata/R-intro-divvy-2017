---
title: "Analyze U of C biking trends from the Divvy data"
author: "Peter Carbonetto"
output: html_document
---

<!-- Define defaults shared by all workflowr files. -->
```{r read-chunk, include=FALSE, cache=FALSE}
knitr::read_chunk("chunks.R")
```

<!-- Update knitr chunk options -->
```{r knitr-opts-chunk, include=FALSE}
```

<!-- Insert the date the file was last updated -->
```{r last-updated, echo=FALSE, results='asis'}
```

<!-- Insert the code version (Git commit SHA1) if Git repository
 exists and R package git2r is installed -->
```{r code-version, echo=FALSE, results='asis'}
```

## Visualizing the usage patterns of University of Chicago Divvy users

```{r, eval=FALSE}
summary(trips.uofc$to_station_name)
```

```{r, eval=FALSE}
uofc.arrival.counts <- as.vector(table(trips.uofc$to_station_name))
head(uofc.arrival.counts)
```

```{r, eval=FALSE}
uofcstn <- "University Ave & 57th St"
uofc.station.dists <-
  sqrt((stations[uofcstn,"latitude"] - stations$latitude)^2 +
       (stations[uofcstn,"longitude"] - stations$longitude)^2)
head(uofc.station.dists)
```

Let's combine these two variables into a single data frame so that we
can plot the relationship between these two variables using ggplot.

```{r, eval=FALSE}
uofc.arrivals <- data.frame(dist  = uofc.station.dists,
                            count = uofc.arrival.counts)
rownames(uofc.arrivals) <- rownames(stations)
head(uofc.arrivals)
```

Note that we are able to combine these data into one data frame only
because we were careful earlier to create factors with levels given in
the same order as the stations in the "stations" data frame.

```{r, eval=FALSE}
ggplot(data    = uofc.arrivals,
       mapping = aes(x = dist,y = count)) +
  geom_point()
```

```{r, eval=FALSE}
ggplot(data    = uofc.arrivals,
       mapping = aes(x = dist,y = count)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10()
```

```{r, eval=FALSE}
plot3 <- ggplot(data    = subset(uofc.arrivals,count > 0 & dist > 0),
                mapping = aes(x = dist,y = count)) +
  geom_point(shape = 4,color = "darkblue") +
  scale_x_log10() +
  scale_y_log10(breaks = c(1,10,100,1000))
```

### Analyzing the linear relationship between two variables

```{r, eval=FALSE}
fit <- lm(data    = subset(uofc.arrivals,count > 0 & dist > 0),
          formula = log10(count) ~ log10(dist))
```

```{r, eval=FALSE}
summary(fit)
```

```{r, eval=FALSE}
b <- coef(fit)
plot3 + geom_abline(intercept = b["(Intercept)"],slope = b["log10(dist)"],
                    color = "red",linetype = "dotted")
```

## Recap

*Recap will go here.*
