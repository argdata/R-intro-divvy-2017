---
title: "Importing and inspecting the Divvy trip data"
author: "Peter Carbonetto"
output: html_document
---

<!-- Define defaults shared by all workflowr files. -->
```{r read-chunk, include=FALSE, cache=FALSE}
knitr::read_chunk("chunks.R")
```

<!-- Update knitr chunk options -->
```{r knitr-opts-chunk, include=FALSE}
```

<!-- Insert the date the file was last updated -->
```{r last-updated, echo=FALSE, results="asis"}
```

<!-- Insert the code version (Git commit SHA1) if Git repository
 exists and R package git2r is installed -->
```{r code-version, echo=FALSE, results="asis"}
```

For this part of the lesson, I'm assuming you have worked through the
code in the [previous episode](stations.html), and your R session is
still open. If you have saved your R session using `save.image`, you
can load it by running `load("workshop.RData")`.

<br>

## Installing the data.table package

Previously, we used "read.csv" to read in the data. However, if we try
to use it for the Divvy Trip data, we will see that it is very slow:

```{r, eval=FALSE}
trips <- read.csv(file = "../data/Divvy_Trips_2016.csv",
                  stringsAsFactors = FALSE,nrows = 1e5)
```

On your computer, it probably took a few seconds to read in the first
100,000 lines in the file. That is tolerable, but consider that there
is a total of 3.6 million lines! Instead, we will use a function
implemented in the `data.table` package that is much faster.

Retrieve and install the package from CRAN:

```{r, eval=FALSE}
install.packages("data.table")
```

Load the package functions into your environment:

```{r, eval=TRUE}
library(data.table)
```

What functions were loaded? What can you do with this package? Use
this command to access the package documentation:

```{r, eval=FALSE}
help(package = data.table)
```

Package "vignettes" are also a great way to learn about a package,
e.g.,

```{r, eval=FALSE}
vignette("datatable-intro")
```
<br>

## Where are my packages?

In most cases, packages are either installed in R software directory,
or in your home directory. This will give you the list of package
installation locations:

```{r, eval=FALSE}
.libPaths()
```

When you install a new package, by default it is installed in the
first location.

To get the full list of packages, run

```{r, eval=FALSE}
installed.packages()
```

or

```{r, eval=FALSE}
rownames(installed.packages)
```

If you want to find out which packages are installed in each location,
run these commands:

```{r, eval=FALSE}
rownames(installed.packages(lib = .libPaths()[1]))
rownames(installed.packages(lib = .libPaths()[2]))
```

## Use data.table to load the Divvy trip data

Let's go ahead and load the data for the 3.6 million trips using the
"fread" funtion from the `data.table` package:

```{r, eval=FALSE}
trips <- fread("../data/Divvy_Trips_2016.csv",sep = ",",header = TRUE,
               stringsAsFactors = FALSE)
trips <- read.csv("../data/Divvy_Trips_2016.csv",
               stringsAsFactors = FALSE)
```

On my MacBook Air, this took about 30 seconds---not too bad. It will
take much longer if you use "read.csv". (Try it!)

## A first peek at the Divvy trip data

```{r, eval=FALSE}
nrow(trips)
ncol(trips)
head(trips)
tail(trips)
summary(trips)
```

## Create some factor columns

*Add text here.*

## Convert dates and times.

*Add text and code here.*

## Recap
